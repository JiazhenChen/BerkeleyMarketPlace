<div class="container" id="profilepage">

  <div class="row">
    <div class="col-lg-2">
      <%=render "users/profilesidebar" %>
    </div>
    
    <div class="col-lg-10">
        
        <%= form_for :user, :method => :post, :html => { :multipart => true } do |f| %>
        <div class="form-group">
            <h4 class="my-4">Profile Image</h1>
            <label for="user_image">
              <div id="imagePreview" class="form-group">
                <img><%= image_tag @profile_img,  id: "Profile Image", class: "img-fluid", alt: "Responsive image", width:  "350"%></img>  
              </div>
            </label>
            <%= f.file_field :image, id: "user_image", style: "display:block", required: true%>
            
            <div class="form-row">
              <div class="col">
                <%= f.submit "Save", class:"btn btn-primary" %>
              </div>
            </div>
        </div>
        <% end %>
        
        <h3>Welcome, you are logged in as <%= current_user.name %></h3>
        <h4>Email</h4>
        <p><%= current_user.email %></p> 
        <h4>Current Notification Preference</h4>
        <p>Please check back later.</p> 
        <h4>Subscription</h4>
        <p>Please check back later.</p> 
    </div>
    
  </div>
</div>


<script>
$(function() {
    $('#imagePreview').on('click', function() {
        $('#profile-image-upload').click();
    });
});

$(function() {
  $('#user_image').on('change', function(event) {
    var files = event.target.files;
    var image = files[0]
    var reader = new FileReader();
    reader.onload = function(file) {
      var img = new Image();
      console.log(file);
      img.src = file.target.result.replace("http", "https");
      img.width = "350";
      //img.height = "auto";
      $('#imagePreview').html(img);
    }
    reader.readAsDataURL(image);
  });
});
</script>
